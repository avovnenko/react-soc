{"ast":null,"code":"import _regeneratorRuntime from\"/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{authAPI}from\"../api/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='auth/SET-USER-DATA';var initialState={userId:null,email:null,login:null,img:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread({},state,{},action.payload);default:return state;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export default authReducer;export var authMe=function authMe(){return function _callee(dispatch){var response,_response$data,id,email,login;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(authAPI.me());case 2:response=_context.sent;if(response.resultCode===0){_response$data=response.data,id=_response$data.id,email=_response$data.email,login=_response$data.login;dispatch(setAuthUserData(id,email,login,true));}case 4:case\"end\":return _context.stop();}}});};};export var userLogin=function userLogin(email,password,rememberMe,captcha){return function _callee2(dispatch){var response;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(authAPI.login(email,password,rememberMe,captcha));case 2:response=_context2.sent;if(response.resultCode===0){dispatch(authMe());}else{dispatch(stopSubmit(\"login\",{_error:response.messages.length>0?response.messages[0]:'Some error!'}));}case 4:case\"end\":return _context2.stop();}}});};};export var userLogout=function userLogout(){return function _callee3(dispatch){var response;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(authAPI.logout());case 2:response=_context3.sent;if(response.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}});};};","map":{"version":3,"sources":["/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/src/redux/authReducer.js"],"names":["authAPI","stopSubmit","SET_USER_DATA","initialState","userId","email","login","img","isAuth","authReducer","state","action","type","payload","setAuthUserData","authMe","dispatch","me","response","resultCode","data","id","userLogin","password","rememberMe","captcha","_error","messages","length","userLogout","logout"],"mappings":"0WAAA,OAAQA,OAAR,KAAsB,YAAtB,CACA,OAAQC,UAAR,KAAyB,YAAzB,CAEA,GAAMC,CAAAA,aAAa,CAAG,oBAAtB,CAEA,GAAIC,CAAAA,YAAY,CAAG,CAClBC,MAAM,CAAE,IADU,CAElBC,KAAK,CAAE,IAFW,CAGlBC,KAAK,CAAE,IAHW,CAIlBC,GAAG,CAAE,IAJa,CAKlBC,MAAM,CAAE,KALU,CAAnB,CAQA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBP,YAAyB,IAAXQ,CAAAA,MAAW,2CAErD,OAAQA,MAAM,CAACC,IAAf,EACC,IAAKV,CAAAA,aAAL,CACC,wBACIQ,KADJ,IAEIC,MAAM,CAACE,OAFX,EAID,QACC,MAAOH,CAAAA,KAAP,CAPF,CASA,CAXD,CAaA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACV,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBE,MAAvB,QAAmC,CAACI,IAAI,CAAEV,aAAP,CAAsBW,OAAO,CAAE,CAACT,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAAuBE,MAAM,CAANA,MAAvB,CAA/B,CAAnC,EAAxB,CAGP,cAAeC,CAAAA,WAAf,CAEA,MAAO,IAAMM,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,SACrB,kBAAOC,QAAP,+MACsBhB,OAAO,CAACiB,EAAR,EADtB,SACKC,QADL,eAGC,GAAIA,QAAQ,CAACC,UAAT,GAAwB,CAA5B,CAA+B,gBACLD,QAAQ,CAACE,IADJ,CACzBC,EADyB,gBACzBA,EADyB,CACrBhB,KADqB,gBACrBA,KADqB,CACdC,KADc,gBACdA,KADc,CAE9BU,QAAQ,CAACF,eAAe,CAACO,EAAD,CAAKhB,KAAL,CAAYC,KAAZ,CAAmB,IAAnB,CAAhB,CAAR,CACA,CANF,8CADqB,EAAf,CASP,MAAO,IAAMgB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACjB,KAAD,CAAQkB,QAAR,CAAkBC,UAAlB,CAA8BC,OAA9B,QACxB,mBAAOT,QAAP,sLACsBhB,OAAO,CAACM,KAAR,CAAcD,KAAd,CAAqBkB,QAArB,CAA+BC,UAA/B,CAA2CC,OAA3C,CADtB,SACKP,QADL,gBAGC,GAAIA,QAAQ,CAACC,UAAT,GAAwB,CAA5B,CAA+B,CAC9BH,QAAQ,CAACD,MAAM,EAAP,CAAR,CACA,CAFD,IAEO,CACNC,QAAQ,CAACf,UAAU,CAAC,OAAD,CAAU,CAACyB,MAAM,CAAER,QAAQ,CAACS,QAAT,CAAkBC,MAAlB,CAA2B,CAA3B,CAA+BV,QAAQ,CAACS,QAAT,CAAkB,CAAlB,CAA/B,CAAsD,aAA/D,CAAV,CAAX,CAAR,CACA,CAPF,+CADwB,EAAlB,CAUP,MAAO,IAAME,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SACzB,mBAAOb,QAAP,sLACsBhB,OAAO,CAAC8B,MAAR,EADtB,SACKZ,QADL,gBAGC,GAAIA,QAAQ,CAACC,UAAT,GAAwB,CAA5B,CAA+B,CAC9BH,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CACA,CALF,+CADyB,EAAnB","sourcesContent":["import {authAPI} from \"../api/api\";\nimport {stopSubmit} from \"redux-form\";\n\nconst SET_USER_DATA = 'auth/SET-USER-DATA';\n\nlet initialState = {\n\tuserId: null,\n\temail: null,\n\tlogin: null,\n\timg: null,\n\tisAuth: false\n};\n\nconst authReducer = (state = initialState, action) => {\n\n\tswitch (action.type) {\n\t\tcase SET_USER_DATA:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\t...action.payload\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nexport const setAuthUserData = (userId, email, login, isAuth) => ({type: SET_USER_DATA, payload: {userId, email, login, isAuth}});\n\n\nexport default authReducer;\n\nexport const authMe = () =>\n\tasync (dispatch) => {\n\t\tlet response = await authAPI.me();\n\n\t\tif (response.resultCode === 0) {\n\t\t\tlet {id, email, login} = response.data;\n\t\t\tdispatch(setAuthUserData(id, email, login, true));\n\t\t}\n\t};\nexport const userLogin = (email, password, rememberMe, captcha) =>\n\tasync (dispatch) => {\n\t\tlet response = await authAPI.login(email, password, rememberMe, captcha);\n\n\t\tif (response.resultCode === 0) {\n\t\t\tdispatch(authMe());\n\t\t} else {\n\t\t\tdispatch(stopSubmit(\"login\", {_error: response.messages.length > 0 ? response.messages[0] : 'Some error!' }));\n\t\t}\n\t};\nexport const userLogout = () =>\n\tasync (dispatch) => {\n\t\tlet response = await authAPI.logout();\n\n\t\tif (response.resultCode === 0) {\n\t\t\tdispatch(setAuthUserData(null, null, null, false));\n\t\t}\n\t};\n"]},"metadata":{},"sourceType":"module"}