{"ast":null,"code":"import _regeneratorRuntime from\"/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";var SHOW_MORE='users/SHOW-MORE',SET_USERS='users/SET-USERS',SET_TOTAL_USERS_COUNT='users/SET-TOTAL-USERS-COUNT',TOGGLE_FOLLOW='users/TOGGLE-FOLLOW',SET_CURRENT_PAGE='users/SET-CURRENT-PAGE',TURN_ON_PRELOADER='users/TURN-ON-PRELOADER',TURN_OFF_PRELOADER='users/TURN-OFF-PRELOADER',FOLLOWING_IN_PROGRESS='users/FOLLOWING-IN-PROGRESS';var initialState={users:[],showUsers:2,pageSize:5,totalUsersCount:0,currentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case TOGGLE_FOLLOW:return _objectSpread({},state,{users:state.users.map(function(u){if(u.id===action.userId){return _objectSpread({},u,{followed:!u.followed});}return u;})});case SET_USERS:return _objectSpread({},state,{users:_toConsumableArray(action.users)});case SET_TOTAL_USERS_COUNT:return _objectSpread({},state,{totalUsersCount:action.totalUsersCount});case SHOW_MORE:return _objectSpread({},state,{showUsers:state.showUsers+2});case SET_CURRENT_PAGE:return _objectSpread({},state,{currentPage:action.currentPage});case TURN_ON_PRELOADER:return _objectSpread({},state,{isFetching:true});case TURN_OFF_PRELOADER:return _objectSpread({},state,{isFetching:false});case FOLLOWING_IN_PROGRESS:return _objectSpread({},state,{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(i){return i!==action.userId;})});default:return state;}};export default usersReducer;export var toggleFollowSuccess=function toggleFollowSuccess(userId){return{type:TOGGLE_FOLLOW,userId:userId};};export var setUsers=function setUsers(users,totalUsersCount){return{type:SET_USERS,users:users,totalUsersCount:totalUsersCount};};export var showMore=function showMore(){return{type:SHOW_MORE};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,totalUsersCount:totalUsersCount};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var turnOnPreloader=function turnOnPreloader(){return{type:TURN_ON_PRELOADER};};export var turnOffPreloader=function turnOffPreloader(){return{type:TURN_OFF_PRELOADER};};export var followingInProgress=function followingInProgress(isFetching,userId){return{type:FOLLOWING_IN_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(currentPage,pageSize){return function _callee(dispatch){var response;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(turnOnPreloader);_context.next=3;return _regeneratorRuntime.awrap(usersAPI.getUsers(currentPage,pageSize));case 3:response=_context.sent;dispatch(setUsers(response.items));dispatch(setTotalUsersCount(response.totalCount));dispatch(turnOffPreloader);case 7:case\"end\":return _context.stop();}}});};};export var toggleFollow=function toggleFollow(toggle,userId){return function _callee2(dispatch){var response;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(followingInProgress(true,userId));if(!toggle){_context2.next=7;break;}_context2.next=4;return _regeneratorRuntime.awrap(usersAPI.followUser(userId));case 4:_context2.t0=_context2.sent;_context2.next=10;break;case 7:_context2.next=9;return _regeneratorRuntime.awrap(usersAPI.unfollowUser(userId));case 9:_context2.t0=_context2.sent;case 10:response=_context2.t0;if(response.resultCode===0){dispatch(toggleFollowSuccess(userId));}dispatch(followingInProgress(false,userId));case 13:case\"end\":return _context2.stop();}}});};};","map":{"version":3,"sources":["/Users/avovnenko/PhpstormProjects/ReactApp/01-first-project/react-2/src/redux/usersReducer.js"],"names":["usersAPI","SHOW_MORE","SET_USERS","SET_TOTAL_USERS_COUNT","TOGGLE_FOLLOW","SET_CURRENT_PAGE","TURN_ON_PRELOADER","TURN_OFF_PRELOADER","FOLLOWING_IN_PROGRESS","initialState","users","showUsers","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","map","u","id","userId","followed","filter","i","toggleFollowSuccess","setUsers","showMore","setTotalUsersCount","setCurrentPage","turnOnPreloader","turnOffPreloader","requestUsers","dispatch","getUsers","response","items","totalCount","toggleFollow","toggle","followUser","unfollowUser","resultCode"],"mappings":"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","sourcesContent":["import {usersAPI} from \"../api/api\";\n\nconst SHOW_MORE = 'users/SHOW-MORE',\n\tSET_USERS = 'users/SET-USERS',\n\tSET_TOTAL_USERS_COUNT = 'users/SET-TOTAL-USERS-COUNT',\n\tTOGGLE_FOLLOW = 'users/TOGGLE-FOLLOW',\n\tSET_CURRENT_PAGE = 'users/SET-CURRENT-PAGE',\n\tTURN_ON_PRELOADER = 'users/TURN-ON-PRELOADER',\n\tTURN_OFF_PRELOADER = 'users/TURN-OFF-PRELOADER',\n\tFOLLOWING_IN_PROGRESS = 'users/FOLLOWING-IN-PROGRESS';\n\nlet initialState = {\n\tusers: [],\n\tshowUsers: 2,\n\tpageSize: 5,\n\ttotalUsersCount: 0,\n\tcurrentPage: 1,\n\tisFetching: false,\n\tfollowingInProgress: []\n};\n\nconst usersReducer = (state = initialState, action) => {\n\n\tswitch (action.type) {\n\t\tcase TOGGLE_FOLLOW:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tusers: state.users.map(u => {\n\t\t\t\t\tif (u.id === action.userId) {\n\t\t\t\t\t\treturn {...u, followed: !u.followed};\n\t\t\t\t\t}\n\t\t\t\t\treturn u;\n\t\t\t\t}),\n\t\t\t};\n\n\t\tcase SET_USERS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tusers: [...action.users]\n\t\t\t};\n\n\t\tcase SET_TOTAL_USERS_COUNT:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\ttotalUsersCount: action.totalUsersCount\n\t\t\t};\n\n\t\tcase SHOW_MORE:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tshowUsers: state.showUsers + 2\n\t\t\t};\n\n\t\tcase SET_CURRENT_PAGE:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcurrentPage: action.currentPage\n\t\t\t};\n\n\t\tcase TURN_ON_PRELOADER:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisFetching: true\n\t\t\t};\n\n\t\tcase TURN_OFF_PRELOADER:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tisFetching: false\n\t\t\t};\n\n\t\tcase FOLLOWING_IN_PROGRESS:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tfollowingInProgress: action.isFetching\n\t\t\t\t\t? [...state.followingInProgress, action.userId]\n\t\t\t\t\t: state.followingInProgress.filter(i => i !== action.userId)\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n\nexport default usersReducer;\n\nexport const toggleFollowSuccess = (userId) => ({type: TOGGLE_FOLLOW, userId});\n\nexport const setUsers = (users, totalUsersCount) => ({type: SET_USERS, users, totalUsersCount});\nexport const showMore = () => ({type: SHOW_MORE});\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, totalUsersCount});\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage});\nexport const turnOnPreloader = () => ({type: TURN_ON_PRELOADER});\nexport const turnOffPreloader = () => ({type: TURN_OFF_PRELOADER});\nexport const followingInProgress = (isFetching, userId) => ({type: FOLLOWING_IN_PROGRESS, isFetching, userId});\n\n\nexport const requestUsers = (currentPage, pageSize) =>\n\tasync (dispatch) => {\n\t\tdispatch(turnOnPreloader);\n\n\t\tlet response = await usersAPI.getUsers(currentPage, pageSize)\n\n\t\tdispatch(setUsers(response.items));\n\t\tdispatch(setTotalUsersCount(response.totalCount));\n\n\t\tdispatch(turnOffPreloader);\n\t};\nexport const toggleFollow = (toggle, userId) =>\n\tasync (dispatch) => {\n\t\tdispatch(followingInProgress(true, userId));\n\t\tlet response = toggle ? await usersAPI.followUser(userId) : await usersAPI.unfollowUser(userId);\n\n\t\tif (response.resultCode === 0) {\n\t\t\tdispatch(toggleFollowSuccess(userId));\n\t\t}\n\n\t\tdispatch(followingInProgress(false, userId));\n\t};"]},"metadata":{},"sourceType":"module"}